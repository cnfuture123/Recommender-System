# 电影推荐系统

## 项目简介

  - 本项目是基于大数据框架的电影推荐系统，包含统计推荐，离线推荐，实时推荐以及基于内容推荐等主要模块。
  
## 项目架构

  - 数据存储：
    - 业务数据库：采用MongoDB作为主数据库，主要负责业务逻辑数据的存储。
    - 缓存数据库：采用Redis作为缓存数据库，主要用于实时推荐部分对于数据查询实时性的要求。
  - 离线推荐部分：
    - 统计推荐：采用Spark Core + Spark SQL进行实现，实现对相关数据的统计任务。
    - 离线推荐：采用Spark Core + Spark MLlib进行实现，采用ALS算法进行实现。
  - 实时推荐部分：
    - 日志采集：采用Flume对用户评分行为进行收集，并实时发送到Kafka。
    - 消息缓冲：采用Kafka作为流式数据的缓存组件，接受来自Flume的数据，并将数据推送到实时推荐系统部分。
    - 实时推荐：采用Spark Streaming构建实时推荐部分，通过设计的推荐算法对从Kafka接收的数据进行处理，并获得实时推荐列表。

## 数据集

本项目数据集共包括三个文件：电影信息(movies.csv)，用户评分信息(ratings.csv)，电影标签信息(tags.csv)。数据集是基于MovieLens改进的格式。

  - 电影信息表字段：ID，名称，描述，时长，发行时间，拍摄时间，语言，类别，演员，导演。
  - 用户评分信息表字段：用户ID，电影ID，评分，评分时间。
  - 电影标签信息表字段：用户ID，电影ID，标签，标签时间。

## 系统模块

### 统计推荐模块

  - 统计推荐模块根据历史数据计算得出以下统计信息：
    - 历史热门电影统计：计算历史评分次数最多的电影。
    - 最近电影热门统计：计算最近时间的月份里面评分数最多的电影。
    - 电影平均得分统计：计算每个电影的平均得分。
    - 各类别Top10电影统计：计算每种类型的电影集合中评分最高的10个电影。
  - ![统计推荐代码参考](./代码/统计推荐)
  
### 离线推荐模块

  - 离线推荐主要流程：
    - 用ALS算法训练隐语义模型，基于RMSE最小化求得最优模型。
    - 通过训练的模型计算用户电影推荐矩阵，返回得分最高的10个电影，作为当前用户的推荐。
    - 通过训练的模型计算电影余弦相似度矩阵，返回得分高于0.6的电影，作为当前电影的推荐。
  - ![离线推荐代码参考](./代码/离线推荐)

### 实时推荐模块

  - 实时推荐基本原理：用户近期的电影喜好是相似的。当Kafka获取到用户对某部电影发生评分行为时，将触发一次对该用户的推荐结果的更新。
  - 实时推荐主要流程：
    - 从Redis取出用户近期有过评分的N部电影。KRatings:Seq[(mid, rating)]
    - 从电影相似矩阵取出当前电影最相似的M部电影作为候选推荐电影集。Movies:Seq[mid]
    - 依次计算每个候选电影的推荐优先级：
      - 候选电影与近期评分电影的相似度：sim(m1, m2)
      - 计算候选电影的推荐优先级：score = rating * sim(m1, m2)
    - 根据推荐优先级从高到低得到合适长度的推荐列表。
  - ![实时推荐代码参考](./代码/实时推荐)
  
### 基于内容的推荐模块

  - 基于内容的推荐流程：
    - 基于TF-IDF算法提取电影类别特征。
    - 通过电影类别特征计算电影相似度，并推荐相似电影。
  - ![基于内容的推荐代码参考](./代码/基于内容的推荐)
  
## 联系方式

  - CHEN NAN(chennansg@126.com)
  
  
